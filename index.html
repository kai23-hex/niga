<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>L·ªùi Ch√∫c T·ª´ Cyrene</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Quicksand:wght@400;600&subset=vietnamese&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        /* --- 1. THI·∫æT L·∫¨P C∆† B·∫¢N --- */
        * { box-sizing: border-box; }
        body {
            margin: 0; padding: 0; height: 100vh;
            background: linear-gradient(135deg, #ffdee9 0%, #b5fffc 100%);
            font-family: 'Quicksand', sans-serif;
            display: flex; justify-content: center; align-items: center;
            overflow: hidden;
            position: relative;
            perspective: 1200px; /* Chi·ªÅu s√¢u 3D */
        }

        /* --- 2. HI·ªÜU ·ª®NG SAO BƒÇNG N·ªÄN --- */
        .sky-container {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 0; pointer-events: none; transform: rotateZ(45deg);
        }
        .shooting_star {
            position: absolute; left: 50%; top: 50%; height: 2px;
            background: linear-gradient(-45deg, #5f91ff, rgba(0, 0, 255, 0));
            border-radius: 999px; filter: drop-shadow(0 0 6px #699bff);
            animation: tail 3000ms ease-in-out infinite, shooting 3000ms ease-in-out infinite;
        }
        .shooting_star::before, .shooting_star::after {
            content: ''; position: absolute; top: calc(50% - 1px); right: 0;
            height: 2px; background: linear-gradient(-45deg, rgba(0, 0, 255, 0), #5f91ff, rgba(0, 0, 255, 0));
            transform: translateX(50%) rotateZ(45deg); border-radius: 100%;
            animation: shining 3000ms ease-in-out infinite;
        }
        .shooting_star::after { transform: translateX(50%) rotateZ(-45deg); }
        @keyframes tail { 0% { width: 0; } 30% { width: 100px; } 100% { width: 0; } }
        @keyframes shooting { 0% { transform: translateX(0); } 100% { transform: translateX(300px); } }
        @keyframes shining { 0% { width: 0; } 50% { width: 30px; } 100% { width: 0; } }
        
        .shooting_star:nth-child(1) { top: 0; left: 0; animation-delay: 0ms; }
        .shooting_star:nth-child(2) { top: 0; left: 50%; animation-delay: 2000ms; }
        .shooting_star:nth-child(3) { top: 50%; left: 0; animation-delay: 4000ms; }
        .shooting_star:nth-child(4) { top: 50%; left: 50%; animation-delay: 6000ms; }

        /* --- 3. M√ÄN H√åNH CH·ªú (Overlay) --- */
        #start-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); 
            z-index: 99999 !important; /* Lu√¥n n·∫±m tr√™n c√πng */
            display: flex; justify-content: center; align-items: center; flex-direction: column;
            color: white; transition: opacity 0.5s;
            backdrop-filter: blur(5px);
        }
        .start-btn {
            margin-top: 20px; padding: 15px 40px; border-radius: 50px;
            background: #ff9a9e; color: white; border: none; font-size: 1.2em; font-weight: bold;
            animation: pulse 2s infinite; cursor: pointer;
            box-shadow: 0 0 20px rgba(255, 154, 158, 0.6);
        }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }

        /* --- 4. TH·∫∫ B√ÄI PHA L√ä 3D --- */
        .memory-card {
            background: rgba(255, 255, 255, 0.65);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.8);
            padding: 30px;
            border-radius: 30px;
            text-align: center;
            width: 85%; max-width: 420px;
            z-index: 10;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.1s ease-out; /* M∆∞·ª£t m√† cho c·∫£m bi·∫øn */
            overflow: hidden;
            
            /* Hi·ªáu ·ª©ng H√†o Quang */
            animation: cardGlow 4s infinite alternate;
        }

        /* ƒê·ªô d√†y th·∫ª (M√†u h·ªìng th·∫°ch anh) */
        .memory-card::before {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            border-radius: 30px;
            background: #e056fd; /* M√†u c·∫°nh th·∫ª */
            transform: translateZ(-10px); /* ƒê·∫©y ra sau */
            box-shadow: 0 30px 40px rgba(0,0,0,0.2);
        }

        /* √Ånh s√°ng qu√©t qua (Shine) */
        .shine-layer {
            position: absolute; top: 0; left: -150%; width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.8), transparent);
            transform: skewX(-25deg); pointer-events: none; transition: 0s;
            mix-blend-mode: overlay;
        }

        @keyframes cardGlow {
            0% { box-shadow: 0 15px 35px rgba(255, 182, 193, 0.3), 0 0 10px rgba(255, 154, 158, 0.1); border-color: rgba(255, 255, 255, 0.8); }
            100% { box-shadow: 0 20px 50px rgba(161, 140, 209, 0.6), 0 0 20px rgba(162, 155, 254, 0.4); border-color: #fff; }
        }

        /* --- 5. N·ªòI DUNG B√äN TRONG (Parallax) --- */
        .avatar-frame {
            width: 120px; height: 120px; margin: 0 auto 15px;
            padding: 5px; border-radius: 50%;
            background: linear-gradient(45deg, #ff9a9e, #a18cd1);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transform: translateZ(30px); /* N·ªïi l√™n */
        }
        .avatar { width: 100%; height: 100%; border-radius: 50%; object-fit: cover; border: 3px solid white; }

        h1 {
            font-family: 'Dancing Script', cursive;
            background: linear-gradient(to right, #e84393, #6c5ce7);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            font-size: 2.2em; margin: 10px 0;
            transform: translateZ(40px);
        }

        p { color: #636e72; font-size: 1.1em; line-height: 1.6; transform: translateZ(25px); font-weight: 600;}

        /* ƒê·ªìng h·ªì ƒë·∫øm ng∆∞·ª£c */
        .countdown-container { 
            display: flex; justify-content: center; gap: 12px; margin: 20px 0; 
            transform: translateZ(35px); 
        }
        .time-bubble {
            background: rgba(255, 255, 255, 0.9);
            width: 60px; height: 70px; border-radius: 15px;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            box-shadow: 0 5px 15px rgba(162, 155, 254, 0.3); border: 1px solid white;
            animation: floatBubble 3s ease-in-out infinite;
        }
        .time-bubble span { font-weight: bold; font-size: 1.5em; color: #6c5ce7; }
        .time-bubble small { font-size: 0.7em; color: #b2bec3; margin-top: 3px; font-weight: bold; }
        
        .time-bubble:nth-child(1) { animation-delay: 0s; }
        .time-bubble:nth-child(2) { animation-delay: 0.5s; }
        .time-bubble:nth-child(3) { animation-delay: 1s; }
        .time-bubble:nth-child(4) { animation-delay: 1.5s; }
        @keyframes floatBubble { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-6px); } }

        /* N√∫t nh·∫≠n qu√† */
        .btn-reveal {
            background: linear-gradient(90deg, #ff9a9e, #fad0c4);
            color: white; border: none;
            padding: 12px 35px; border-radius: 50px;
            font-size: 1.1em; font-weight: bold; cursor: pointer;
            box-shadow: 0 5px 15px rgba(255, 154, 158, 0.4);
            transition: transform 0.3s;
            display: none; font-family: 'Quicksand', sans-serif;
            transform: translateZ(50px);
        }
        .btn-reveal:hover { transform: scale(1.05) translateZ(50px); }
        
        #gift-area { display: none; margin-top: 20px; animation: fadeIn 1s; transform: translateZ(30px); }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    </style>
</head>
<body>

    <div id="start-overlay">
        <h2 style="font-family: 'Dancing Script'; font-size: 2.5em; text-align: center;">B·∫°n c√≥ m·ªôt m√≥n qu√†! üéÅ</h2>
        <p style="margin-top:0;">ƒêeo tai nghe ƒë·ªÉ tr·∫£i nghi·ªám t·ªët nh·∫•t</p>
        <button class="start-btn" onclick="startExperience()">Ch·∫°m ƒë·ªÉ m·ªü ‚ú®</button>
    </div>

    <div class="sky-container">
        <div class="shooting_star"></div><div class="shooting_star"></div>
        <div class="shooting_star"></div><div class="shooting_star"></div>
    </div>

    <div class="memory-card" id="card3d">
        <div class="shine-layer" id="shine"></div>

        <div class="avatar-frame">
            <img src="https://i.postimg.cc/rs4WbSWp/33.jpg" alt="Avatar" class="avatar">
        </div>

        <h1 id="title-text">Ch·ªù ƒê·ª£i Kho·∫£nh Kh·∫Øc...</h1>

        <p id="msg-text">
            "Nh·ªØng k√Ω ·ª©c ƒë·∫πp nh·∫•t ƒëang ƒë∆∞·ª£c k·∫øt tinh.<br>
            H√£y ki√™n nh·∫´n th√™m m·ªôt ch√∫t n·ªØa nh√©, Ch·ªã H·∫≠u..."
        </p>

        <div class="countdown-container" id="countdown">
            <div class="time-bubble"><span id="d">00</span><small>Ng√†y</small></div>
            <div class="time-bubble"><span id="h">00</span><small>Gi·ªù</small></div>
            <div class="time-bubble"><span id="m">00</span><small>Ph√∫t</small></div>
            <div class="time-bubble"><span id="s">00</span><small>Gi√¢y</small></div>
        </div>

        <button class="btn-reveal" id="btn-gift" onclick="openMemory()">‚ú¶ Thu Th·∫≠p K√Ω ·ª®c ‚ú¶</button>

        <div id="gift-area">
            <p style="color: #6c5ce7; font-weight: bold;">ƒê√£ l∆∞u v√†o V√πng ƒê·∫•t K√Ω ·ª®c:</p>
            üå∏ 1x L·ªùi Ch√∫c Vƒ©nh C·ª≠u<br>
            üíé 1x Pha L√™ H·∫°nh Ph√∫c<br>
            <small>(Lu√¥n m·ªâm c∆∞·ªùi nh√©! ‚ô™)</small>
        </div>
    </div>

    <audio id="bgMusic" loop>
        <source src="nhac.mp3" type="audio/mpeg">
    </audio>

    <script>
        // --- 1. RESET TR·∫†NG TH√ÅI KHI T·∫¢I L·∫†I TRANG ---
        window.onload = function() {
            var overlay = document.getElementById('start-overlay');
            if (overlay) {
                overlay.style.display = 'flex';
                overlay.style.opacity = '1';
            }
        };

        const card = document.getElementById("card3d");
        const shine = document.getElementById("shine");
        const bgMusic = document.getElementById("bgMusic");

        // --- 2. H√ÄM KH·ªûI ƒê·ªòNG (N√∫t Ch·∫°m ƒë·ªÉ m·ªü) ---
        function startExperience() {
            // ·∫®n m√†n h√¨nh ch·ªù
            document.getElementById('start-overlay').style.opacity = '0';
            setTimeout(() => { document.getElementById('start-overlay').style.display = 'none'; }, 500);

            // Ph√°t nh·∫°c & Gi·∫£m volume
            if(bgMusic) { bgMusic.volume = 0.3; bgMusic.play().catch(e => console.log(e)); }

            // Xin quy·ªÅn iOS
            if (typeof DeviceOrientationEvent !== 'undefined' && typeof DeviceOrientationEvent.requestPermission === 'function') {
                DeviceOrientationEvent.requestPermission()
                    .then(permissionState => {
                        if (permissionState === 'granted') {
                            window.addEventListener('deviceorientation', handleOrientation);
                        }
                    })
                    .catch(console.error);
            } else {
                // Android/PC
                window.addEventListener('deviceorientation', handleOrientation);
            }
        }

        // --- 3. X·ª¨ L√ù C·∫¢M BI·∫æN (GYROSCOPE) ---
        function handleOrientation(event) {
            let x = event.beta;  // Nghi√™ng tr∆∞·ªõc sau
            let y = event.gamma; // Nghi√™ng tr√°i ph·∫£i
            
            // Fix l·ªói null
            if (x === null || y === null) return;

            // Gi·ªõi h·∫°n g√≥c
            if (x > 30) x = 30; if (x < -30) x = -30;
            if (y > 30) y = 30; if (y < -30) y = -30;

            // Xoay th·∫ª
            card.style.transform = `rotateX(${-x}deg) rotateY(${y}deg)`;
            
            // Hi·ªáu ·ª©ng b√≥ng ƒë·ªï n·ªïi
            let shadowX = -y * 0.5; let shadowY = x * 0.5;
            card.style.boxShadow = `${shadowX}px ${shadowY + 15}px 35px rgba(255, 182, 193, 0.4)`;

            // Di chuy·ªÉn √°nh s√°ng (Shine)
            let moveShine = -150 + (y * 3); // T√≠nh to√°n v·ªã tr√≠
            shine.style.left = moveShine + '%';
        }

        // --- 4. X·ª¨ L√ù C·∫¢M ·ª®NG (TOUCH FALLBACK) ---
        document.addEventListener("touchmove", (e) => {
            if (window.innerWidth > 800) return;
            let touch = e.touches[0];
            let xAxis = (window.innerWidth / 2 - touch.pageX) / 20;
            let yAxis = (window.innerHeight / 2 - touch.pageY) / 20;
            card.style.transform = `rotateY(${xAxis}deg) rotateX(${yAxis}deg)`;
        });
        document.addEventListener("touchend", () => {
            card.style.transform = `rotateY(0deg) rotateX(0deg)`;
        });

        // --- 5. X·ª¨ L√ù CHU·ªòT (PC) ---
        document.addEventListener("mousemove", (e) => {
            if(window.innerWidth < 800) return;
            let xAxis = (window.innerWidth / 2 - e.pageX) / 25;
            let yAxis = (window.innerHeight / 2 - e.pageY) / 25;
            card.style.transform = `rotateY(${xAxis}deg) rotateX(${yAxis}deg)`;
            shine.style.left = (150 - (xAxis * 5)) + '%'; // Di chuy·ªÉn shine ng∆∞·ª£c chi·ªÅu chu·ªôt
        });
        document.addEventListener("mouseleave", () => {
            card.style.transform = `rotateY(0deg) rotateX(0deg)`;
        });

        // --- 6. ƒê·ªíNG H·ªí ƒê·∫æM NG∆Ø·ª¢C ---
        const birthdayTime = new Date("December 24, 2025 11:00:00").getTime();

        const timer = setInterval(function() {
            const now = new Date().getTime();
            const distance = birthdayTime - now;

            const d = Math.floor(distance / (1000 * 60 * 60 * 24));
            const h = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const m = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const s = Math.floor((distance % (1000 * 60)) / 1000);

            if(document.getElementById("d")) {
                document.getElementById("d").innerText = d < 10 ? "0"+d : d;
                document.getElementById("h").innerText = h < 10 ? "0"+h : h;
                document.getElementById("m").innerText = m < 10 ? "0"+m : m;
                document.getElementById("s").innerText = s < 10 ? "0"+s : s;
            }

            if (distance < 0) {
                clearInterval(timer);
                document.getElementById("countdown").style.display = "none";
                
                const title = document.getElementById("title-text");
                title.innerText = "Ch√∫c M·ª´ng Sinh Nh·∫≠t!";
                title.style.fontSize = "3em";
                
                const msg = document.getElementById("msg-text");
                msg.innerHTML = "Th·ªùi gian tr√¥i ƒëi nh∆∞ nh·ªØng c√°nh hoa r∆°i, nh∆∞ng nh·ªØng k√Ω ·ª©c ƒë·∫πp v·ªÅ ch·ªã th√¨ s·∫Ω lu√¥n ng∆∞ng ƒë·ªçng m√£i.<br>Sinh nh·∫≠t vui v·∫ª nh√©!";
                
                document.getElementById("btn-gift").style.display = "inline-block";
                
                // B·∫Øn ph√°o hoa k·∫øt th√∫c
                launchFireworks();
            }
        }, 1000);

        // --- 7. C√ÅC H√ÄM HI·ªÜU ·ª®NG ---
        function launchFireworks() {
            var duration = 15 * 1000;
            var animationEnd = Date.now() + duration;
            var defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 0 };
            function randomInRange(min, max) { return Math.random() * (max - min) + min; }
            var interval = setInterval(function() {
                var timeLeft = animationEnd - Date.now();
                if (timeLeft <= 0) { return clearInterval(interval); }
                var particleCount = 50 * (timeLeft / duration);
                confetti(Object.assign({}, defaults, { particleCount, origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 } }));
                confetti(Object.assign({}, defaults, { particleCount, origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 } }));
            }, 250);
        }

        function openMemory() {
            // B·∫Øn ph√°o gi·∫•y
            var colors = ['#ff9a9e', '#a18cd1', '#fad0c4'];
            (function frame() {
                confetti({ particleCount: 5, angle: 60, spread: 55, origin: { x: 0 }, colors: colors });
                confetti({ particleCount: 5, angle: 120, spread: 55, origin: { x: 1 }, colors: colors });
                if (Date.now() < (Date.now() + 2000)) { requestAnimationFrame(frame); }
            }());

            // Hi·ªán qu√†
            document.getElementById("gift-area").style.display = "block";
            
            // ƒê·ªïi n√∫t (nh∆∞ng v·∫´n cho b·∫•m l·∫°i)
            var btn = document.getElementById("btn-gift");
            btn.innerText = "ƒê√£ L∆∞u! ‚ù§Ô∏è";

            // ƒê·∫£m b·∫£o nh·∫°c ch·∫°y
            if(bgMusic.paused) bgMusic.play();
        }
    </script>
</body>
</html>
